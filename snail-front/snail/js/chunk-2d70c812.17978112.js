(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d70c812"],{"0304":function(e,t,s){},"6f4a":function(e,t,s){"use strict";s("0304")},"81c1":function(e,t,s){"use strict";s.d(t,"x",(function(){return n})),s.d(t,"r",(function(){return o})),s.d(t,"y",(function(){return a})),s.d(t,"D",(function(){return i})),s.d(t,"F",(function(){return c})),s.d(t,"c",(function(){return u})),s.d(t,"s",(function(){return l})),s.d(t,"o",(function(){return d})),s.d(t,"J",(function(){return f})),s.d(t,"U",(function(){return m})),s.d(t,"X",(function(){return p})),s.d(t,"i",(function(){return h})),s.d(t,"K",(function(){return b})),s.d(t,"v",(function(){return g})),s.d(t,"w",(function(){return y})),s.d(t,"p",(function(){return v})),s.d(t,"L",(function(){return w})),s.d(t,"B",(function(){return P})),s.d(t,"I",(function(){return O})),s.d(t,"C",(function(){return k})),s.d(t,"G",(function(){return j})),s.d(t,"H",(function(){return C})),s.d(t,"V",(function(){return x})),s.d(t,"q",(function(){return L})),s.d(t,"j",(function(){return _})),s.d(t,"T",(function(){return F})),s.d(t,"t",(function(){return I})),s.d(t,"M",(function(){return M})),s.d(t,"k",(function(){return B})),s.d(t,"P",(function(){return S})),s.d(t,"Q",(function(){return T})),s.d(t,"z",(function(){return V})),s.d(t,"e",(function(){return $})),s.d(t,"f",(function(){return N})),s.d(t,"g",(function(){return A})),s.d(t,"n",(function(){return z})),s.d(t,"N",(function(){return D})),s.d(t,"O",(function(){return G})),s.d(t,"a",(function(){return E})),s.d(t,"u",(function(){return H})),s.d(t,"l",(function(){return R})),s.d(t,"R",(function(){return U})),s.d(t,"A",(function(){return J})),s.d(t,"d",(function(){return q})),s.d(t,"S",(function(){return K})),s.d(t,"h",(function(){return Q})),s.d(t,"m",(function(){return W})),s.d(t,"E",(function(){return X})),s.d(t,"b",(function(){return Y})),s.d(t,"W",(function(){return Z}));var r=s("7f80"),n="/snail/actModel/export/",o="/snail/actModel/deployByFile",a="/snail/actProcess/export",i="/snail/actProcess/getHighlightImg/",c=function(e){return Object(r["b"])("/actModel/getByCondition",e)},u=function(e){return Object(r["e"])("/actModel/add",e)},l=function(e,t){return Object(r["b"])("/actModel/deploy/".concat(e),t)},d=function(e){return Object(r["e"])("/actModel/delByIds",e)},f=function(e){return Object(r["b"])("/actProcess/getByCondition",e)},m=function(e){return Object(r["e"])("/actProcess/updateInfo",e)},p=function(e){return Object(r["e"])("/actProcess/updateStatus",e)},h=function(e,t){return Object(r["b"])("/actProcess/convertToModel/".concat(e),t)},b=function(e,t){return Object(r["b"])("/actProcess/getProcessNode/".concat(e),t)},g=function(e){return Object(r["e"])("/actProcess/editNodeUser",e)},y=function(e){return Object(r["e"])("/actProcess/editStartUser",e)},v=function(e){return Object(r["e"])("/actProcess/delByIds",e)},w=function(e){return Object(r["b"])("/actProcess/getRunningProcess",e)},P=function(e){return Object(r["b"])("/actProcess/getFinishedProcess",e)},O=function(e,t){return Object(r["b"])("/actProcess/getByKey/".concat(e),t)},k=function(e,t){return Object(r["b"])("/actProcess/getFirstNode/".concat(e),t)},j=function(e,t,s){return Object(r["b"])("/actProcess/getNextNode/".concat(e,"/").concat(t),s)},C=function(e,t){return Object(r["b"])("/actProcess/getNode/".concat(e),t)},x=function(e){return Object(r["e"])("/actProcess/updateInsStatus",e)},L=function(e){return Object(r["e"])("/actProcess/delInsByIds",e)},_=function(e){return Object(r["e"])("/actProcess/delHistoricInsByIds",e)},F=function(e){return Object(r["b"])("/actTask/todoList",e)},I=function(e){return Object(r["b"])("/actTask/doneList",e)},M=function(e,t){return Object(r["b"])("/actTask/historicFlow/".concat(e),t)},B=function(e){return Object(r["e"])("/actTask/delegate",e)},S=function(e){return Object(r["e"])("/actTask/pass",e)},T=function(e){return Object(r["e"])("/actTask/passAll",e)},V=function(e,t){return Object(r["b"])("/actTask/getBackList/".concat(e),t)},$=function(e){return Object(r["e"])("/actTask/back",e)},N=function(e){return Object(r["e"])("/actTask/backAll",e)},A=function(e){return Object(r["e"])("/actTask/backToTask",e)},z=function(e){return Object(r["e"])("/actTask/deleteHistoric",e)},D=function(e){return Object(r["b"])("/actCategory/getByParentId/0",e)},G=function(e,t){return Object(r["b"])("/actCategory/getByParentId/".concat(e),t)},E=function(e){return Object(r["e"])("/actCategory/add",e)},H=function(e){return Object(r["e"])("/actCategory/edit",e)},R=function(e){return Object(r["e"])("/actCategory/delByIds",e)},U=function(e){return Object(r["b"])("/actCategory/search",e)},J=function(e){return Object(r["b"])("/actBusiness/getByCondition",e)},q=function(e){return Object(r["e"])("/actBusiness/apply",e)},K=function(e){return Object(r["e"])("/actBusiness/start",e)},Q=function(e){return Object(r["e"])("/actBusiness/cancel",e)},W=function(e){return Object(r["e"])("/actBusiness/delByIds",e)},X=function(e,t){return Object(r["b"])("/leave/get/".concat(e),t)},Y=function(e){return Object(r["e"])("/leave/add",e)},Z=function(e){return Object(r["f"])("/leave/update",e)}},f4f1:function(e,t,s){"use strict";s.r(t);var r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("Drawer",{attrs:{title:"选择流程",closable:"",width:"820",draggable:""},model:{value:e.processModalVisible,callback:function(t){e.processModalVisible=t},expression:"processModalVisible"}},[s("div",{staticClass:"apply-operation"},[s("div",[s("Form",{ref:"searchProcessForm",attrs:{model:e.searchProcessForm,inline:"","label-width":70}},[s("FormItem",{attrs:{label:"流程名称",prop:"name"}},[s("Input",{staticStyle:{width:"140px"},attrs:{type:"text",clearable:"",placeholder:"请输入流程名"},model:{value:e.searchProcessForm.name,callback:function(t){e.$set(e.searchProcessForm,"name",t)},expression:"searchProcessForm.name"}})],1),s("FormItem",{attrs:{label:"所属分类",prop:"category"}},[s("Cascader",{staticStyle:{width:"140px"},attrs:{data:e.category,"load-data":e.loadData,"change-on-select":"",filterable:"",clearable:"",placeholder:"请选择分类"},on:{"on-change":e.handleChangeCat},model:{value:e.selectCat,callback:function(t){e.selectCat=t},expression:"selectCat"}})],1),s("FormItem",{staticClass:"br",staticStyle:{"margin-left":"-70px"}},[s("Button",{attrs:{type:"primary",icon:"ios-search"},on:{click:e.searchProcess}},[e._v("搜索")]),s("Button",{on:{click:e.handleResetProcess}},[e._v("重置")]),s("i-switch",{staticStyle:{margin:"0 5px"},attrs:{size:"large"},on:{"on-change":e.searchProcess},model:{value:e.searchProcessForm.showLatest,callback:function(t){e.$set(e.searchProcessForm,"showLatest",t)},expression:"searchProcessForm.showLatest"}},[s("span",{attrs:{slot:"open"},slot:"open"},[e._v("最新")]),s("span",{attrs:{slot:"close"},slot:"close"},[e._v("全部")])])],1)],1)],1),s("div",[s("RadioGroup",{attrs:{type:"button"},model:{value:e.showType,callback:function(t){e.showType=t},expression:"showType"}},[s("Radio",{attrs:{title:"缩略图",label:"thumb"}},[s("Icon",{attrs:{type:"ios-apps"}})],1),s("Radio",{attrs:{title:"列表",label:"list"}},[s("Icon",{attrs:{type:"md-list"}})],1)],1)],1)]),"thumb"==e.showType?s("div",{staticClass:"process-wrapper",style:{maxHeight:e.maxHeight+"px"}},[e._l(e.processData,(function(t,r){return s("Card",{key:r,staticClass:"process-card"},[s("div",{staticClass:"content",on:{click:function(s){return e.showApply(t)}}},[s("div",{staticClass:"other"},[s("div",{staticClass:"name"},[e._v(e._s(r+1)+". "+e._s(t.name))]),s("div",{staticClass:"key"},[e._v(e._s(t.description))]),s("div",{staticClass:"info"},[e._v("版本：v."+e._s(t.version)+" 所属分类："+e._s(t.categoryTitle))])])])])})),e.processLoading?s("Spin",{attrs:{fix:""}}):e._e()],2):e._e(),"list"==e.showType?s("Table",{ref:"processTable",attrs:{height:e.maxHeight,loading:e.processLoading,border:"",columns:e.processColumns,data:e.processData}}):e._e(),s("Row",{staticClass:"process-choose-drawer-footer"},[s("Page",{attrs:{current:e.searchProcessForm.pageNumber,total:e.processTotal,"page-size":e.searchProcessForm.pageSize,"page-size-opts":[10,20,50],size:"small","show-elevator":"","show-sizer":""},on:{"on-change":e.changeProcessPage,"on-page-size-change":e.changeProcessPageSize}})],1)],1),s("Modal",{attrs:{title:"提交申请","mask-closable":!1,width:500},model:{value:e.applyModalVisible,callback:function(t){e.applyModalVisible=t},expression:"applyModalVisible"}},[s("Form",{ref:"form",attrs:{model:e.form,"label-width":85,rules:e.formValidate}},[s("FormItem",{attrs:{label:"标题",prop:"title"}},[s("Input",{attrs:{placeholder:"请输入标题",clearable:""},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),s("FormItem",{directives:[{name:"show",rawName:"v-show",value:e.showAssign,expression:"showAssign"}],attrs:{label:"选择审批人",prop:"assignees",error:e.error}},[s("Select",{attrs:{placeholder:"请选择或输入搜索",filterable:"",clearable:"",multiple:"",loading:e.userLoading},model:{value:e.form.assignees,callback:function(t){e.$set(e.form,"assignees",t)},expression:"form.assignees"}},e._l(e.assigneeList,(function(t,r){return s("Option",{key:r,attrs:{value:t.id,label:t.nickname}},[s("span",{staticStyle:{"margin-right":"10px"}},[e._v(e._s(t.nickname))]),s("span",{staticStyle:{color:"#ccc"}},[e._v(e._s(t.username))])])})),1)],1),s("FormItem",{directives:[{name:"show",rawName:"v-show",value:e.isCustom,expression:"isCustom"}],attrs:{label:"自定义搜索选择审批人",prop:"assignees",error:e.error}},[s("Select",{attrs:{placeholder:"请输入用户名搜索选择用户",filterable:"",remote:"",multiple:"","remote-method":e.searchUser,loading:e.userLoading},model:{value:e.form.assignees,callback:function(t){e.$set(e.form,"assignees",t)},expression:"form.assignees"}},e._l(e.userList,(function(t,r){return s("Option",{key:r,attrs:{value:t.id,label:t.nickname}},[s("span",{staticStyle:{"margin-right":"10px"}},[e._v(e._s(t.nickname))]),s("span",{staticStyle:{color:"#ccc"}},[e._v(e._s(t.username))])])})),1)],1),s("FormItem",{directives:[{name:"show",rawName:"v-show",value:e.isGateway,expression:"isGateway"}],attrs:{label:"下一审批人"}},[s("span",[e._v("分支网关处暂不支持自定义选择下一审批人，将发送给下一节点所有人")])]),s("FormItem",{attrs:{label:"优先级",prop:"priority"}},[s("Select",{attrs:{placeholder:"请选择",clearable:""},model:{value:e.form.priority,callback:function(t){e.$set(e.form,"priority",t)},expression:"form.priority"}},e._l(e.dictPriority,(function(t,r){return s("Option",{key:r,attrs:{value:t.value}},[e._v(e._s(t.title))])})),1)],1),s("FormItem",{attrs:{label:"消息通知"}},[s("Checkbox",{model:{value:e.form.sendMessage,callback:function(t){e.$set(e.form,"sendMessage",t)},expression:"form.sendMessage"}},[e._v("站内消息通知")]),s("Checkbox",{model:{value:e.form.sendSms,callback:function(t){e.$set(e.form,"sendSms",t)},expression:"form.sendSms"}},[e._v("短信通知")]),s("Checkbox",{model:{value:e.form.sendEmail,callback:function(t){e.$set(e.form,"sendEmail",t)},expression:"form.sendEmail"}},[e._v("邮件通知")])],1)],1),s("div",{attrs:{slot:"footer"},slot:"footer"},[s("Button",{attrs:{type:"text"},on:{click:function(t){e.applyModalVisible=!1}}},[e._v("取消")]),s("Button",{attrs:{type:"primary",loading:e.submitLoading},on:{click:e.handelSubmit}},[e._v("提交")])],1)],1)],1)},n=[],o=s("81c1"),a=s("365c"),i={name:"processChoose",props:{value:{type:Boolean,default:!1},actBusinessId:String},data:function(){var e=this;return{processModalVisible:this.value,maxHeight:510,userLoading:!1,error:"",showAssign:!1,isGateway:!1,isCustom:!1,submitLoading:!1,processLoading:!0,applyModalVisible:!1,selectCat:[],category:[],processData:[],showType:"thumb",searchProcessForm:{showLatest:!0,filter:!0,name:"",status:"1",pageNumber:1,pageSize:10,sort:"createTime",order:"desc"},form:{title:"",procDefId:"",assignees:[],priority:"0",sendMessage:!0,sendSms:!0,sendEmail:!0},formValidate:{title:[{required:!0,message:"不能为空",trigger:"change"}],priority:[{required:!0,message:"不能为空",trigger:"change"}]},assigneeList:[],dictPriority:this.$store.state.dict.priority,processColumns:[{type:"index",width:60,align:"center"},{title:"名称",key:"name",width:150,sortable:!0},{title:"备注描述",key:"description",width:150,sortable:!0},{title:"所属分类",key:"categoryTitle",width:150,sortable:!0},{title:"版本",key:"version",align:"center",sortable:!0,render:function(e,t){var s="";return t.row.version&&(s="v."+t.row.version),e("div",s)}},{title:"操作",key:"action",width:135,align:"center",fixed:"right",render:function(t,s){return t("div",[t("Button",{props:{type:"info",size:"small"},on:{click:function(){e.showApply(s.row)}}},"选择该流程")])}}],userList:[]}},methods:{init:function(){this.getProcessList(),this.initCategoryData()},getProcessList:function(){var e=this;this.processLoading=!0,Object(o["J"])(this.searchProcessForm).then((function(t){e.processLoading=!1,t.success&&(e.processData=t.result.content)}))},changeProcessPage:function(e){this.searchProcessForm.pageNumber=e,this.getProcessList()},changeProcessPageSize:function(e){this.searchProcessForm.pageSize=e,this.getProcessList()},searchProcess:function(){this.searchProcessForm.pageNumber=1,this.getProcessList()},searchUser:function(e){var t=this;e&&(this.userLoading=!0,Object(a["Lc"])(e).then((function(e){t.userLoading=!1,e.success&&(t.userList=e.result)})))},initCategoryData:function(){var e=this;Object(o["N"])().then((function(t){t.success&&(t.result.forEach((function(e){e.isParent?(e.value=e.id,e.label=e.title,e.loading=!1,e.children=[]):(e.value=e.id,e.label=e.title),-1==e.status&&(e.label="[已禁用] "+e.label,e.disabled=!0)})),e.category=t.result)}))},loadData:function(e,t){e.loading=!0,Object(o["O"])(e.value).then((function(s){e.loading=!1,s.success&&(s.result.forEach((function(e){e.isParent?(e.value=e.id,e.label=e.title,e.loading=!1,e.children=[]):(e.value=e.id,e.label=e.title),-1==e.status&&(e.label="[已禁用] "+e.label,e.disabled=!0)})),e.children=s.result,t())}))},handleChangeCat:function(e,t){var s="";e&&e.length>0&&(s=e[e.length-1]),this.searchProcessForm.categoryId=s},handleResetProcess:function(){this.$refs.searchProcessForm.resetFields(),this.searchProcessForm.categoryId="",this.selectCat=[],this.getProcessList()},showApply:function(e){var t=this;e.routeName?(this.form.procDefId=e.id,this.form.title=e.name,this.userLoading=!0,Object(o["C"])(e.id).then((function(e){if(t.userLoading=!1,e.success){if(t.error="",3==e.result.type||4==e.result.type)return t.isGateway=!0,t.form.firstGateway=!0,t.showAssign=!1,void(t.isCustom=!1);if(5==e.result.type)return t.isCustom=!0,t.isGateway=!1,t.form.firstGateway=!1,void(t.showAssign=!1);if(1==e.result.type)if(t.showAssign=!0,t.isGateway=!1,t.form.firstGateway=!1,t.isCustom=!1,e.result.users&&e.result.users.length>0){t.assigneeList=e.result.users;var s=[];e.result.users.forEach((function(e){s.push(e.id)})),t.form.assignees=s,t.showAssign=!0}else t.form.assignees=[],t.showAssign=!0,t.error='请进入"流程管理"为审批节点分配候选审批人员'}})),this.applyModalVisible=!0):this.$Message.warning("该流程信息未完善，请于流程管理中编辑流程完善信息")},handelSubmit:function(){var e=this;this.$refs.form.validate((function(t){if(t){if((e.showAssign||e.isCustom)&&e.form.assignees.length<1)return void(e.error="请至少选择一个审批人");if(e.error="",e.form.id=e.actBusinessId,!e.form.id)return void e.$Message.error("请传入业务表ActBusiness的ID");e.submitLoading=!0,Object(o["S"])(e.form).then((function(t){e.submitLoading=!1,t.success&&(e.$Message.success("操作成功"),e.applyModalVisible=!1,e.processModalVisible=!1,e.$emit("on-submit",!0),e.form.id="")}))}}))},setCurrentValue:function(e){e!==this.processModalVisible&&(this.processModalVisible=e)}},watch:{value:function(e){this.setCurrentValue(e)},processModalVisible:function(e){this.$emit("input",e)}},mounted:function(){this.maxHeight=Number(document.documentElement.clientHeight-180),this.init()}},c=i,u=(s("6f4a"),s("2877")),l=Object(u["a"])(c,r,n,!1,null,null,null);t["default"]=l.exports}}]);