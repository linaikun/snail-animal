(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-34a71096","chunk-326397f7"],{"3d66":function(e,t,s){},"40d1":function(e,t,s){"use strict";s("3d66")},4158:function(e,t,s){"use strict";s.r(t);var n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"search"},[s("Card",{staticStyle:{"margin-bottom":"10px"}},[s("div",{attrs:{slot:"title"},slot:"title"},[s("div",{staticClass:"edit-head"},[s("a",{staticClass:"back-title",on:{click:e.close}},[s("Icon",{attrs:{type:"ios-arrow-back"}}),e._v("返回 ")],1),s("div",{staticClass:"head-name"},[e._v("流程审批进度历史")]),s("span"),s("a",{staticClass:"window-close",on:{click:e.close}},[s("Icon",{staticClass:"ivu-icon-ios-close",attrs:{type:"ios-close",size:"31"}})],1)])]),s("Row",{staticStyle:{position:"relative"}},[s("Table",{ref:"table",attrs:{loading:e.loading,border:"",columns:e.columns,data:e.data}}),s("div",{staticClass:"img-title"},[e._v("实时流程图")]),s("Row",{staticStyle:{position:"relative"}},[s("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.imgUrl,expression:"imgUrl"}]}),e.loadingImg?s("Spin",{attrs:{size:"large",fix:""}}):e._e()],1),e.loading?s("Spin",{attrs:{size:"large",fix:""}}):e._e()],1)],1)],1)},r=[],i=s("81c1"),a=s("c276"),o={name:"historic_detail",props:{procInstId:String},data:function(){return{loading:!1,loadingImg:!1,columns:[{type:"selection",width:60,align:"center"},{type:"index",width:60,align:"center"},{title:"任务名称",key:"name",minWidth:120,sortable:!0},{title:"处理人",key:"assignees",align:"center",sortable:!0,minWidth:150,render:function(e,t){if(t.row.assignees)return e("div",t.row.assignees.map((function(t,s){return t.isExecutor?e("Tooltip",{props:{placement:"top",content:t.username}},[e("Tag",{style:{"margin-right":"8px"},props:{type:"border",color:"primary"}},t.nickname)]):e("Tooltip",{props:{placement:"top",content:t.username}},[e("Tag",{style:{"margin-right":"8px"},props:{type:"border"}},t.nickname)])})))}},{title:"审批操作",key:"deleteReason",align:"center",minWidth:150,sortable:!0},{title:"审批意见",key:"comment",align:"center",minWidth:120,sortable:!0},{title:"耗时",key:"duration",align:"center",width:100,sortable:!0,render:function(e,t){return e("div",a["a"].millsToTime(t.row.duration))}},{title:"创建时间",key:"createTime",width:170,sortType:"asc",sortable:!0},{title:"完成时间",key:"endTime",width:170,sortable:!0},{title:"状态",align:"center",width:120,render:function(e,t){var s="",n="";return t.row.endTime?(n="blue",s="已办理"):(n="default",s="待处理"),e("div",[e("Tag",{props:{color:n}},s)])}}],data:[],id:"",imgUrl:"",backRoute:""}},methods:{init:function(){this.$route.query.id?(this.id=this.$route.query.id,this.backRoute=this.$route.query.backRoute):this.id=this.procInstId,this.imgUrl=i["D"]+this.id+"?accessToken="+this.getStore("accessToken")+"&time="+new Date,this.getDataList()},getDataList:function(){var e=this;this.loading=!0,Object(i["M"])(this.id).then((function(t){e.loading=!1,t.success&&(e.data=t.result,t.result&&0!=t.result.length||e.$Modal.info({title:"未找到该记录审批历史数据",content:"历史数据可能已被删除"}))}))},close:function(){this.$route.query.id?(this.$store.commit("removeTag","historic_detail"),localStorage.pageOpenedList=JSON.stringify(this.$store.state.app.pageOpenedList),this.$router.push({name:this.backRoute})):this.$emit("close",!0)}},mounted:function(){this.init()},watch:{$route:function(e,t){"historic_detail"==e.name&&this.init()}}},c=o,l=(s("40d1"),s("2877")),u=Object(l["a"])(c,n,r,!1,null,null,null);t["default"]=u.exports},"6c6d":function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var n=[{text:"今日",value:function(){var e=new Date,t=new Date;return e.setTime(t.getTime()),[t,e]}},{text:"昨日",value:function(){var e=new Date,t=new Date;return t.setTime(t.getTime()-864e5),e.setTime(e.getTime()-864e5),[t,e]}},{text:"本周",value:function(){var e=new Date,t=e.getDay(),s=e.getDate(),n=e.getMonth(),r=t||7,i=new Date(e.getFullYear(),n,s+1-r),a=new Date(e.getFullYear(),n,s+7-r);return i.setTime(i.getTime()),a.setTime(a.getTime()),[i,a]}},{text:"本月",value:function(){var e=new Date,t=e.getYear();t+=t<2e3?1900:0;var s=e.getMonth(),n=new Date(t,s,1),r=new Date(t,s+1,1),i=(r-n)/864e5,a=new Date(t,s,1),o=new Date(t,s,i);return a.setTime(a.getTime()),o.setTime(o.getTime()),[a,o]}}]},"81c1":function(e,t,s){"use strict";s.d(t,"x",(function(){return r})),s.d(t,"r",(function(){return i})),s.d(t,"y",(function(){return a})),s.d(t,"D",(function(){return o})),s.d(t,"F",(function(){return c})),s.d(t,"c",(function(){return l})),s.d(t,"s",(function(){return u})),s.d(t,"o",(function(){return d})),s.d(t,"J",(function(){return m})),s.d(t,"U",(function(){return h})),s.d(t,"X",(function(){return f})),s.d(t,"i",(function(){return p})),s.d(t,"K",(function(){return g})),s.d(t,"v",(function(){return b})),s.d(t,"w",(function(){return k})),s.d(t,"p",(function(){return y})),s.d(t,"L",(function(){return v})),s.d(t,"B",(function(){return w})),s.d(t,"I",(function(){return T})),s.d(t,"C",(function(){return I})),s.d(t,"G",(function(){return S})),s.d(t,"H",(function(){return L})),s.d(t,"V",(function(){return O})),s.d(t,"q",(function(){return x})),s.d(t,"j",(function(){return _})),s.d(t,"T",(function(){return j})),s.d(t,"t",(function(){return D})),s.d(t,"M",(function(){return F})),s.d(t,"k",(function(){return $})),s.d(t,"P",(function(){return C})),s.d(t,"Q",(function(){return M})),s.d(t,"z",(function(){return B})),s.d(t,"e",(function(){return P})),s.d(t,"f",(function(){return N})),s.d(t,"g",(function(){return A})),s.d(t,"n",(function(){return V})),s.d(t,"N",(function(){return E})),s.d(t,"O",(function(){return z})),s.d(t,"a",(function(){return R})),s.d(t,"u",(function(){return U})),s.d(t,"l",(function(){return H})),s.d(t,"R",(function(){return K})),s.d(t,"A",(function(){return W})),s.d(t,"d",(function(){return G})),s.d(t,"S",(function(){return q})),s.d(t,"h",(function(){return J})),s.d(t,"m",(function(){return Y})),s.d(t,"E",(function(){return Q})),s.d(t,"b",(function(){return X})),s.d(t,"W",(function(){return Z}));var n=s("7f80"),r="/snail/actModel/export/",i="/snail/actModel/deployByFile",a="/snail/actProcess/export",o="/snail/actProcess/getHighlightImg/",c=function(e){return Object(n["b"])("/actModel/getByCondition",e)},l=function(e){return Object(n["e"])("/actModel/add",e)},u=function(e,t){return Object(n["b"])("/actModel/deploy/".concat(e),t)},d=function(e){return Object(n["e"])("/actModel/delByIds",e)},m=function(e){return Object(n["b"])("/actProcess/getByCondition",e)},h=function(e){return Object(n["e"])("/actProcess/updateInfo",e)},f=function(e){return Object(n["e"])("/actProcess/updateStatus",e)},p=function(e,t){return Object(n["b"])("/actProcess/convertToModel/".concat(e),t)},g=function(e,t){return Object(n["b"])("/actProcess/getProcessNode/".concat(e),t)},b=function(e){return Object(n["e"])("/actProcess/editNodeUser",e)},k=function(e){return Object(n["e"])("/actProcess/editStartUser",e)},y=function(e){return Object(n["e"])("/actProcess/delByIds",e)},v=function(e){return Object(n["b"])("/actProcess/getRunningProcess",e)},w=function(e){return Object(n["b"])("/actProcess/getFinishedProcess",e)},T=function(e,t){return Object(n["b"])("/actProcess/getByKey/".concat(e),t)},I=function(e,t){return Object(n["b"])("/actProcess/getFirstNode/".concat(e),t)},S=function(e,t,s){return Object(n["b"])("/actProcess/getNextNode/".concat(e,"/").concat(t),s)},L=function(e,t){return Object(n["b"])("/actProcess/getNode/".concat(e),t)},O=function(e){return Object(n["e"])("/actProcess/updateInsStatus",e)},x=function(e){return Object(n["e"])("/actProcess/delInsByIds",e)},_=function(e){return Object(n["e"])("/actProcess/delHistoricInsByIds",e)},j=function(e){return Object(n["b"])("/actTask/todoList",e)},D=function(e){return Object(n["b"])("/actTask/doneList",e)},F=function(e,t){return Object(n["b"])("/actTask/historicFlow/".concat(e),t)},$=function(e){return Object(n["e"])("/actTask/delegate",e)},C=function(e){return Object(n["e"])("/actTask/pass",e)},M=function(e){return Object(n["e"])("/actTask/passAll",e)},B=function(e,t){return Object(n["b"])("/actTask/getBackList/".concat(e),t)},P=function(e){return Object(n["e"])("/actTask/back",e)},N=function(e){return Object(n["e"])("/actTask/backAll",e)},A=function(e){return Object(n["e"])("/actTask/backToTask",e)},V=function(e){return Object(n["e"])("/actTask/deleteHistoric",e)},E=function(e){return Object(n["b"])("/actCategory/getByParentId/0",e)},z=function(e,t){return Object(n["b"])("/actCategory/getByParentId/".concat(e),t)},R=function(e){return Object(n["e"])("/actCategory/add",e)},U=function(e){return Object(n["e"])("/actCategory/edit",e)},H=function(e){return Object(n["e"])("/actCategory/delByIds",e)},K=function(e){return Object(n["b"])("/actCategory/search",e)},W=function(e){return Object(n["b"])("/actBusiness/getByCondition",e)},G=function(e){return Object(n["e"])("/actBusiness/apply",e)},q=function(e){return Object(n["e"])("/actBusiness/start",e)},J=function(e){return Object(n["e"])("/actBusiness/cancel",e)},Y=function(e){return Object(n["e"])("/actBusiness/delByIds",e)},Q=function(e,t){return Object(n["b"])("/leave/get/".concat(e),t)},X=function(e){return Object(n["e"])("/leave/add",e)},Z=function(e){return Object(n["f"])("/leave/update",e)}},"994f":function(e,t,s){"use strict";s.r(t);var n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"search"},[e.showHistory?s("historicDetail",{attrs:{procInstId:e.procInstId},on:{close:function(t){e.showHistory=!1}}}):e._e(),s("Card",{directives:[{name:"show",rawName:"v-show",value:!e.showHistory,expression:"!showHistory"}]},[s("Row",{directives:[{name:"show",rawName:"v-show",value:e.openSearch,expression:"openSearch"}],nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSearch(t)}}},[s("Form",{ref:"searchForm",attrs:{model:e.searchForm,inline:"","label-width":70}},[s("FormItem",{attrs:{label:"任务名称",prop:"name"}},[s("Input",{staticStyle:{width:"200px"},attrs:{type:"text",placeholder:"请输入",clearable:""},model:{value:e.searchForm.name,callback:function(t){e.$set(e.searchForm,"name",t)},expression:"searchForm.name"}})],1),s("FormItem",{attrs:{label:"创建时间"}},[s("DatePicker",{staticStyle:{width:"200px"},attrs:{options:e.options,type:"daterange",format:"yyyy-MM-dd",clearable:"",placeholder:"选择起始时间"},on:{"on-change":e.selectDateRange},model:{value:e.selectDate,callback:function(t){e.selectDate=t},expression:"selectDate"}})],1),s("FormItem",{staticClass:"br",staticStyle:{"margin-left":"-35px"}},[s("Button",{attrs:{type:"primary",icon:"ios-search"},on:{click:e.handleSearch}},[e._v("搜索")]),s("Button",{on:{click:e.handleReset}},[e._v("重置")])],1)],1)],1),s("Row",{staticClass:"operation"},[s("Button",{attrs:{icon:"md-checkmark-circle-outline"},on:{click:e.passAllTask}},[e._v("批量通过")]),s("Button",{attrs:{icon:"md-close"},on:{click:e.backAllTask}},[e._v("批量驳回")]),s("Button",{attrs:{icon:"md-refresh"},on:{click:e.getDataList}},[e._v("刷新")]),s("Button",{attrs:{type:"dashed"},on:{click:function(t){e.openSearch=!e.openSearch}}},[e._v(e._s(e.openSearch?"关闭搜索":"开启搜索"))]),s("Button",{attrs:{type:"dashed"},on:{click:function(t){e.openTip=!e.openTip}}},[e._v(e._s(e.openTip?"关闭提示":"开启提示"))])],1),s("Row",{directives:[{name:"show",rawName:"v-show",value:e.openTip,expression:"openTip"}]},[s("Alert",{attrs:{"show-icon":""}},[e._v(" 已选择 "),s("span",{staticClass:"select-count"},[e._v(e._s(e.selectList.length))]),e._v(" 项 "),s("a",{staticClass:"select-clear",on:{click:e.clearSelectAll}},[e._v("清空")])])],1),s("Row",[s("Table",{ref:"table",attrs:{loading:e.loading,border:"",columns:e.columns,sortable:"custom",data:e.data},on:{"on-sort-change":e.changeSort,"on-selection-change":e.showSelect}})],1),s("Row",{staticClass:"page",attrs:{type:"flex",justify:"end"}},[s("Page",{attrs:{current:e.searchForm.pageNumber,total:e.total,"page-size":e.searchForm.pageSize,"page-size-opts":[10,20,50],size:"small","show-total":"","show-elevator":"","show-sizer":""},on:{"on-change":e.changePage,"on-page-size-change":e.changePageSize}})],1)],1),s("Modal",{attrs:{title:e.modalTaskTitle,"mask-closable":!1,width:500},model:{value:e.modalTaskVisible,callback:function(t){e.modalTaskVisible=t},expression:"modalTaskVisible"}},[s("Form",{ref:"form",attrs:{model:e.form,"label-width":85,rules:e.formValidate}},[s("FormItem",{attrs:{label:"审批意见",prop:"reason"}},[s("Input",{attrs:{type:"textarea",rows:4},model:{value:e.form.comment,callback:function(t){e.$set(e.form,"comment",t)},expression:"form.comment"}})],1),s("FormItem",{directives:[{name:"show",rawName:"v-show",value:e.showAssign,expression:"showAssign"}],attrs:{label:"下一审批人",prop:"assignees",error:e.error}},[s("Select",{attrs:{placeholder:"请选择或输入搜索",filterable:"",clearable:"",multiple:"",loading:e.userLoading},model:{value:e.form.assignees,callback:function(t){e.$set(e.form,"assignees",t)},expression:"form.assignees"}},e._l(e.assigneeList,(function(t,n){return s("Option",{key:n,attrs:{value:t.id,label:t.nickname}},[s("span",{staticStyle:{"margin-right":"10px"}},[e._v(e._s(t.nickname))]),s("span",{staticStyle:{color:"#ccc"}},[e._v(e._s(t.username))])])})),1)],1),s("FormItem",{directives:[{name:"show",rawName:"v-show",value:e.isCustom,expression:"isCustom"}],attrs:{label:"自定义搜索选择审批人",prop:"assignees",error:e.error}},[s("Select",{attrs:{placeholder:"请输入用户名搜索选择用户",filterable:"",remote:"",multiple:"","remote-method":e.searchUser,loading:e.userLoading},model:{value:e.form.assignees,callback:function(t){e.$set(e.form,"assignees",t)},expression:"form.assignees"}},e._l(e.userList,(function(t,n){return s("Option",{key:n,attrs:{value:t.id,label:t.nickname}},[s("span",{staticStyle:{"margin-right":"10px"}},[e._v(e._s(t.nickname))]),s("span",{staticStyle:{color:"#ccc"}},[e._v(e._s(t.username))])])})),1)],1),s("FormItem",{directives:[{name:"show",rawName:"v-show",value:e.isGateway,expression:"isGateway"}],attrs:{label:"下一审批人"}},[s("span",[e._v("分支网关处暂不支持自定义选择下一审批人，将发送给下一节点所有人")])]),s("div",{directives:[{name:"show",rawName:"v-show",value:1==e.form.type,expression:"form.type == 1"}]},[s("FormItem",{attrs:{label:"驳回至"}},[s("Select",{attrs:{filterable:"",loading:e.backLoading},on:{"on-change":e.changeBackTask},model:{value:e.form.backTaskKey,callback:function(t){e.$set(e.form,"backTaskKey",t)},expression:"form.backTaskKey"}},e._l(e.backList,(function(t,n){return s("Option",{key:n,attrs:{value:t.key}},[e._v(e._s(t.name))])})),1)],1),s("FormItem",{directives:[{name:"show",rawName:"v-show",value:-1!=e.form.backTaskKey,expression:"form.backTaskKey != -1"}],attrs:{label:"指定原节点审批人",prop:"assignees",error:e.error}},[s("Select",{attrs:{placeholder:"请选择或输入搜索",filterable:"",clearable:"",multiple:"",loading:e.userLoading},model:{value:e.form.assignees,callback:function(t){e.$set(e.form,"assignees",t)},expression:"form.assignees"}},e._l(e.assigneeList,(function(t,n){return s("Option",{key:n,attrs:{value:t.id,label:t.nickname}},[s("span",{staticStyle:{"margin-right":"10px"}},[e._v(e._s(t.nickname))]),s("span",{staticStyle:{color:"#ccc"}},[e._v(e._s(t.username))])])})),1)],1)],1),s("FormItem",{directives:[{name:"show",rawName:"v-show",value:2==e.form.type,expression:"form.type == 2"}],attrs:{label:"选择转办人",prop:"userId",error:e.error}},[s("Select",{attrs:{placeholder:"请输入用户名搜索选择用户",filterable:"",remote:"","remote-method":e.searchUser,loading:e.userLoading},model:{value:e.form.userId,callback:function(t){e.$set(e.form,"userId",t)},expression:"form.userId"}},e._l(e.userList,(function(t,n){return s("Option",{key:n,attrs:{value:t.id,label:t.nickname}},[s("span",{staticStyle:{"margin-right":"10px"}},[e._v(e._s(t.nickname))]),s("span",{staticStyle:{color:"#ccc"}},[e._v(e._s(t.username))])])})),1)],1),s("FormItem",{attrs:{label:"消息通知"}},[s("Checkbox",{model:{value:e.form.sendMessage,callback:function(t){e.$set(e.form,"sendMessage",t)},expression:"form.sendMessage"}},[e._v("站内消息通知")]),s("Checkbox",{model:{value:e.form.sendSms,callback:function(t){e.$set(e.form,"sendSms",t)},expression:"form.sendSms"}},[e._v("短信通知")]),s("Checkbox",{model:{value:e.form.sendEmail,callback:function(t){e.$set(e.form,"sendEmail",t)},expression:"form.sendEmail"}},[e._v("邮件通知")])],1)],1),s("div",{attrs:{slot:"footer"},slot:"footer"},[s("Button",{attrs:{type:"text"},on:{click:function(t){e.modalTaskVisible=!1}}},[e._v("取消")]),s("Button",{attrs:{type:"primary",loading:e.submitLoading},on:{click:e.handelSubmit}},[e._v("提交")])],1)],1),s("Modal",{attrs:{title:e.modalTitle,"mask-closable":!1,width:500},model:{value:e.modalVisible,callback:function(t){e.modalVisible=t},expression:"modalVisible"}},[s("Alert",{attrs:{"show-icon":""}},[e._v(e._s(0==e.modalType?"注意：将默认分配给节点设定的所有可审批用户":"注意：所有流程将驳回至发起人"))]),s("Form",{ref:"form",attrs:{model:e.form,"label-width":85,rules:e.formValidate}},[s("FormItem",{attrs:{label:"审批意见",prop:"reason"}},[s("Input",{attrs:{type:"textarea",rows:4},model:{value:e.form.comment,callback:function(t){e.$set(e.form,"comment",t)},expression:"form.comment"}})],1),s("FormItem",{attrs:{label:"消息通知"}},[s("Checkbox",{model:{value:e.form.sendMessage,callback:function(t){e.$set(e.form,"sendMessage",t)},expression:"form.sendMessage"}},[e._v("站内消息通知")]),s("Checkbox",{model:{value:e.form.sendSms,callback:function(t){e.$set(e.form,"sendSms",t)},expression:"form.sendSms"}},[e._v("短信通知")]),s("Checkbox",{model:{value:e.form.sendEmail,callback:function(t){e.$set(e.form,"sendEmail",t)},expression:"form.sendEmail"}},[e._v("邮件通知")])],1)],1),s("div",{attrs:{slot:"footer"},slot:"footer"},[s("Button",{attrs:{type:"text"},on:{click:function(t){e.modalVisible=!1}}},[e._v("取消")]),s("Button",{attrs:{type:"primary",loading:e.submitLoading},on:{click:e.handelSubmitAll}},[e._v("提交")])],1)],1)],1)},r=[],i=s("81c1"),a=s("365c"),o=s("4158"),c=s("6c6d"),l={name:"todo-manage",components:{historicDetail:o["default"]},data:function(){var e=this;return{modalVisible:!1,modalType:0,showHistory:!1,procInstId:"",openSearch:!0,openTip:!0,loading:!0,modalTaskVisible:!1,userLoading:!1,backLoading:!1,userList:[],selectList:[],assigneeList:[],backList:[{key:"-1",name:"发起人"}],error:"",showAssign:!1,searchForm:{name:"",pageNumber:1,pageSize:10},selectDate:null,options:{shortcuts:c["a"]},modalTaskTitle:"",modalTitle:"",form:{id:"",userId:"",procInstId:"",comment:"",type:0,assignees:[],backTaskKey:"-1",sendMessage:!0,sendSms:!0,sendEmail:!0},formValidate:{},submitLoading:!1,columns:[{type:"selection",width:60,align:"center"},{type:"index",width:60,align:"center"},{title:"任务名称",key:"name",minWidth:160},{title:"所属流程",key:"processName",minWidth:150,render:function(e,t){var s="";return t.row.version&&(s=t.row.processName+" - v."+t.row.version),e("div",[e("span",s)])}},{title:"委托代办人",key:"owner",minWidth:130,align:"center",render:function(e,t){return t.row.owner?e("Tooltip",{props:{placement:"top",content:t.row.ownerUsername}},[e("Tag",{style:{"margin-right":"8px"},props:{type:"border"}},t.row.owner)]):e("span","-")}},{title:"流程发起人",key:"applyer",minWidth:130,align:"center",render:function(e,t){return e("Tooltip",{props:{placement:"top",content:t.row.applyerUsername}},[e("Tag",{style:{"margin-right":"8px"},props:{type:"border"}},t.row.applyer)])}},{title:"优先级",key:"priority",width:100,sortable:!0,align:"center",render:function(t,s){var n="无",r="";return r=0==s.row.priority?"green":1==s.row.priority?"orange":2==s.row.priority?"red":"default",e.dictPriority.forEach((function(e){e.value==s.row.priority&&(n=e.title)})),t("div",[t("Tag",{props:{color:r}},n)])}},{title:"状态",key:"isSuspended",align:"center",width:110,render:function(e,t){return t.row.isSuspended?t.row.isSuspended?e("div",[e("Badge",{props:{status:"error",text:"已挂起"}})]):void 0:e("div",[e("Badge",{props:{status:"success",text:"已激活"}})])},filters:[{label:"已激活",value:!1},{label:"已挂起",value:!0}],filterMultiple:!1,filterMethod:function(e,t){return e?1==t.isSuspended:e?void 0:0==t.isSuspended}},{title:"创建时间",key:"createTime",width:180,sortType:"desc",sortable:!0},{title:"操作",key:"action",align:"center",width:280,fixed:"right",render:function(t,s){return t("div",[t("a",{on:{click:function(){e.detail(s.row)}}},"申请详情"),t("Divider",{props:{type:"vertical"}}),t("a",{on:{click:function(){e.passTask(s.row)}}},"通过"),t("Divider",{props:{type:"vertical"}}),t("a",{on:{click:function(){e.backTask(s.row)}}},"驳回"),t("Divider",{props:{type:"vertical"}}),t("a",{on:{click:function(){e.delegateTask(s.row)}}},"转办"),t("Divider",{props:{type:"vertical"}}),t("a",{on:{click:function(){e.history(s.row)}}},"历史")])}}],data:[],total:0,dictPriority:[],isGateway:!1,isCustom:!1}},methods:{init:function(){this.getDictDataType(),this.getDataList()},getDictDataType:function(){var e=this;Object(a["Nb"])("priority").then((function(t){t.success&&(e.dictPriority=t.result)}))},searchUser:function(e){var t=this;e&&(this.userLoading=!0,Object(a["Lc"])(e).then((function(e){t.userLoading=!1,e.success&&(t.userList=e.result)})))},changeSort:function(e){this.searchForm.sort=e.key,this.searchForm.order=e.order,"normal"==e.order&&(this.searchForm.order=""),this.getDataList()},changePage:function(e){this.searchForm.pageNumber=e,this.getDataList(),this.clearSelectAll()},changePageSize:function(e){this.searchForm.pageSize=e,this.getDataList()},selectDateRange:function(e){e&&(this.searchForm.startDate=e[0],this.searchForm.endDate=e[1])},getDataList:function(){var e=this;this.loading=!0,Object(i["T"])(this.searchForm).then((function(t){e.loading=!1,t.success&&(e.data=t.result.content,e.total=t.result.totalElements,0==e.data.length&&e.searchForm.pageNumber>1&&(e.searchForm.pageNumber-=1,e.getDataList()))}))},handleSearch:function(){this.searchForm.pageNumber=1,this.searchForm.pageSize=10,this.getDataList()},handleReset:function(){this.$refs.searchForm.resetFields(),this.searchForm.pageNumber=1,this.searchForm.pageSize=10,this.selectDate=null,this.searchForm.startDate="",this.searchForm.endDate="",this.getDataList()},showSelect:function(e){this.selectList=e},clearSelectAll:function(){this.$refs.table.selectAll(!1)},handelSubmit:function(){var e=this;if(this.submitLoading=!0,0==this.form.type){if((this.showAssign||this.isCustom)&&this.form.assignees.length<1)return this.error="请至少选择一个审批人",void(this.submitLoading=!1);this.error="",Object(i["P"])(this.form).then((function(t){e.submitLoading=!1,t.success&&(e.$Message.success("操作成功"),e.modalTaskVisible=!1,e.getDataList())}))}else if(1==this.form.type)if("-1"==this.form.backTaskKey)Object(i["e"])(this.form).then((function(t){e.submitLoading=!1,t.success&&(e.$Message.success("操作成功"),e.modalTaskVisible=!1,e.getDataList())}));else{if("-1"!=this.form.backTaskKey&&this.form.assignees.length<1)return this.error="请至少选择一个审批人",void(this.submitLoading=!1);this.error="",Object(i["g"])(this.form).then((function(t){e.submitLoading=!1,t.success&&(e.$Message.success("操作成功"),e.modalTaskVisible=!1,e.getDataList())}))}else if(2==this.form.type){if(!this.form.userId)return this.error="请搜索选择一转办人",void(this.submitLoading=!1);this.error="",Object(i["k"])(this.form).then((function(t){e.submitLoading=!1,t.success&&(e.$Message.success("操作成功"),e.modalTaskVisible=!1,e.getDataList())}))}},detail:function(e){var t={id:e.tableId,type:3,backRoute:this.$route.name};this.$router.push({name:e.routeName,query:t})},passTask:function(e){var t=this;this.modalTaskTitle="审批通过",this.form.id=e.id,this.form.procInstId=e.procInstId,this.form.priority=e.priority,this.form.type=0,this.modalTaskVisible=!0,this.userLoading=!0,Object(i["G"])(e.procDefId,e.key).then((function(e){if(t.userLoading=!1,e.success){if(t.error="",3==e.result.type||4==e.result.type)return t.isGateway=!0,t.showAssign=!1,void(t.isCustom=!1);if(5==e.result.type)return t.isCustom=!0,t.isGateway=!1,void(t.showAssign=!1);if(1==e.result.type)if(t.showAssign=!0,t.isGateway=!1,t.isCustom=!1,e.result.users&&e.result.users.length>0){t.assigneeList=e.result.users;var s=[];e.result.users.forEach((function(e){s.push(e.id)})),t.form.assignees=s,t.showAssign=!0}else t.form.assignees=[],t.showAssign=!1}}))},changeBackTask:function(e){var t=this;"-1"!=e&&(this.userLoading=!0,Object(i["H"])(e,{taskId:this.form.id}).then((function(e){if(t.userLoading=!1,e.success&&e.result.users&&e.result.users.length>0){t.assigneeList=e.result.users;var s=[];e.result.users.forEach((function(e){s.push(e.id)})),t.form.assignees=s}})))},backTask:function(e){var t=this;this.modalTaskTitle="审批驳回",this.form.id=e.id,this.form.procInstId=e.procInstId,this.form.procDefId=e.procDefId,this.form.priority=e.priority,this.form.type=1,this.showAssign=!1,this.isCustom=!1,this.modalTaskVisible=!0,this.backList=[{key:"-1",name:"发起人"}],this.form.backTaskKey="-1",this.backLoading=!0,Object(i["z"])(e.procInstId).then((function(e){t.backLoading=!1,e.success&&e.result.forEach((function(e){t.backList.push(e)}))}))},delegateTask:function(e){this.modalTaskTitle="委托他人代办",this.form.id=e.id,this.form.procInstId=e.procInstId,this.form.type=2,this.showAssign=!1,this.isCustom=!1,this.modalTaskVisible=!0},history:function(e){e.procInstId?(this.procInstId=e.procInstId,this.showHistory=!0):this.$Message.error("流程实例ID不存在")},passAllTask:function(){this.selectList.length<=0?this.$Message.warning("您还未选择要通过的数据"):(this.modalVisible=!0,this.modalType=0,this.modalTitle="批量通过 "+this.selectList.length+" 条数据")},backAllTask:function(){this.selectList.length<=0?this.$Message.warning("您还未选择要驳回的数据"):(this.modalVisible=!0,this.modalType=1,this.modalTitle="批量驳回 "+this.selectList.length+" 条数据")},handelSubmitAll:function(){var e=this;if(0==this.modalType){var t="",s={};this.selectList.forEach((function(e){t+=e.id+","})),t=t.substring(0,t.length-1),s={ids:t,comment:this.form.comment,sendMessage:this.form.sendMessage,sendSms:this.form.sendSms,sendEmail:this.form.sendEmail},Object(i["Q"])(s).then((function(t){e.$Modal.remove(),t.success&&(e.$Message.info(t.message),e.modalVisible=!1,e.clearSelectAll(),e.getDataList())}))}else{var n="",r={};this.selectList.forEach((function(e){n+=e.procInstId+","})),n=n.substring(0,n.length-1),r={procInstIds:n,comment:this.form.comment,sendMessage:this.form.sendMessage,sendSms:this.form.sendSms,sendEmail:this.form.sendEmail},Object(i["f"])(r).then((function(t){e.$Modal.remove(),t.success&&(e.$Message.success("操作成功"),e.modalVisible=!1,e.clearSelectAll(),e.getDataList())}))}}},mounted:function(){this.init()},watch:{$route:function(e,t){"todo-manage"==e.name&&this.getDataList()}}},u=l,d=(s("dd33"),s("2877")),m=Object(d["a"])(u,n,r,!1,null,null,null);t["default"]=m.exports},ca13:function(e,t,s){},dd33:function(e,t,s){"use strict";s("ca13")}}]);