(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-507be4f6","chunk-c8ae4838","chunk-7a77d620","chunk-bb469c6e"],{"0808":function(t,e,a){},"09b5":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticStyle:{display:"flex"}},[a("Input",{staticStyle:{"margin-right":"10px"},attrs:{readonly:"",placeholder:t.placeholder,clearable:t.clearable},on:{"on-clear":t.clearSelect},model:{value:t.departmentTitle,callback:function(e){t.departmentTitle=e},expression:"departmentTitle"}}),a("Poptip",{attrs:{transfer:"",trigger:"click",placement:"right",title:"选择部门",width:"250"}},[a("Button",{attrs:{icon:"md-list"}},[t._v("选择部门")]),a("div",{attrs:{slot:"content"},slot:"content"},[a("Input",{attrs:{suffix:"ios-search",placeholder:"输入部门名搜索",clearable:""},on:{"on-change":t.searchDep},model:{value:t.searchKey,callback:function(e){t.searchKey=e},expression:"searchKey"}}),a("div",{staticClass:"dep-tree-bar"},[a("Tree",{attrs:{data:t.dataDep,"load-data":t.loadData,multiple:t.multiple},on:{"on-select-change":t.selectTree}}),t.depLoading?a("Spin",{attrs:{size:"large",fix:""}}):t._e()],1)],1)],1)],1)])},s=[],n=a("365c"),i={name:"departmentTreeChoose",props:{multiple:{type:Boolean,default:!1},clearable:{type:Boolean,default:!0},placeholder:{type:String,default:"点击选择部门"}},data:function(){return{depLoading:!1,departmentTitle:"",searchKey:"",dataDep:[],selectDep:[],departmentId:[]}},methods:{initDepartmentData:function(){var t=this;Object(n["tc"])().then((function(e){e.success&&(e.result.forEach((function(t){t.isParent&&(t.loading=!1,t.children=[]),-1==t.status&&(t.title="[已禁用] "+t.title,t.disabled=!0)})),t.dataDep=e.result)}))},loadData:function(t,e){Object(n["vc"])(t.id).then((function(t){t.success&&(t.result.forEach((function(t){t.isParent&&(t.loading=!1,t.children=[]),-1==t.status&&(t.title="[已禁用] "+t.title,t.disabled=!0)})),e(t.result))}))},searchDep:function(){var t=this;this.searchKey?(this.depLoading=!0,Object(n["Ic"])({title:this.searchKey}).then((function(e){t.depLoading=!1,e.success&&(e.result.forEach((function(t){-1==t.status&&(t.title="[已禁用] "+t.title,t.disabled=!0)})),t.dataDep=e.result)}))):this.initDepartmentData()},selectTree:function(t){var e=[],a="";t.forEach((function(t){e.push(t.id),a=""==a?t.title:a+"、"+t.title})),this.departmentId=e,this.departmentTitle=a,this.multiple?this.$emit("on-change",this.departmentId):this.$emit("on-change",this.departmentId[0])},clearSelect:function(){this.departmentId=[],this.departmentTitle="",this.initDepartmentData(),this.multiple?this.$emit("on-change",[]):this.$emit("on-change",""),this.$emit("on-clear")},setData:function(t,e){this.departmentTitle=e,this.multiple?this.departmentId=t:(this.departmentId=[],this.departmentId.push(t)),this.$emit("on-change",this.departmentId)}},mounted:function(){this.initDepartmentData()}},o=i,l=(a("6c1f"),a("2877")),c=Object(l["a"])(o,r,s,!1,null,null,null);e["default"]=c.exports},"0bd5":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticStyle:{display:"flex"}},[a("div",{staticStyle:{width:"100%","margin-right":"10px"}},[a("Input",{attrs:{placeholder:t.placeholder,size:t.size,disabled:t.disabled,readonly:t.readonly,maxlength:t.maxlength,icon:"md-eye"},on:{"on-change":t.handleChange},model:{value:t.currentValue,callback:function(e){t.currentValue=e},expression:"currentValue"}},[a("Poptip",{staticStyle:{width:"17px",cursor:"pointer"},attrs:{slot:"append",transfer:"",trigger:"hover",title:"图片预览",placement:"right",width:"350"},slot:"append"},[a("Button",{attrs:{type:"primary",icon:"md-eye"}}),a("div",{attrs:{slot:"content"},slot:"content"},[a("img",{directives:[{name:"show",rawName:"v-show",value:t.currentValue,expression:"currentValue"}],staticStyle:{width:"100%",margin:"0 auto",display:"block",cursor:"zoom-in"},attrs:{src:t.currentValue},on:{click:t.viewImage}}),a("span",{directives:[{name:"show",rawName:"v-show",value:!t.currentValue,expression:"!currentValue"}]},[t._v("无效的图片链接")]),a("a",{directives:[{name:"show",rawName:"v-show",value:t.currentValue,expression:"currentValue"}],staticStyle:{"margin-top":"5px","text-align":"right",display:"block"},on:{click:t.viewImage}},[t._v("查看大图")])])],1)],1)],1),a("Upload",{attrs:{action:t.uploadFileUrl,headers:t.accessToken,"on-success":t.handleSuccess,"on-error":t.handleError,format:t.format,accept:t.accept,"max-size":1024*t.maxSize,"on-format-error":t.handleFormatError,"on-exceeded-size":t.handleMaxSize,"before-upload":t.beforeUpload,"show-upload-list":!1,"v-show":t.showUpload}},[a("Button",{attrs:{loading:t.loading,size:t.size,disabled:t.disabled,icon:t.icon}},[t._v("上传图片")])],1)],1)])},s=[],n=(a("0808"),a("6a37")),i=a.n(n),o=a("365c"),l={name:"uploadPicInput",props:{value:String,size:String,placeholder:{type:String,default:"可输入图片链接"},disabled:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},maxlength:Number,icon:{type:String,default:"ios-cloud-upload-outline"},maxSize:{type:Number,default:5},accept:{type:String,default:".jpg, .jpeg, .png, .gif"},showUpload:{type:Boolean,default:!0}},computed:{format:function(){if(this.accept){var t=[];return this.accept.split(",").forEach((function(e){t.push(e.replace(".","").replace(" ",""))})),t}return[]}},data:function(){return{accessToken:{},currentValue:this.value,loading:!1,uploadFileUrl:o["Xc"]}},methods:{init:function(){this.accessToken={accessToken:this.getStore("accessToken")}},viewImage:function(){var t=new Image;t.src=this.currentValue;var e=new i.a(t,{hidden:function(){e.destroy()}});e.show()},handleFormatError:function(t){this.loading=!1,this.$Notice.warning({title:"不支持的文件格式",desc:"所选文件‘ "+t.name+" ’格式不正确, 请选择 "+this.accept+" 格式文件"})},handleMaxSize:function(t){this.loading=!1,this.$Notice.warning({title:"文件大小过大",desc:"所选文件‘ "+t.name+" ’大小过大, 不得超过 "+this.maxSize+"M."})},beforeUpload:function(){return this.loading=!0,!0},handleSuccess:function(t,e){this.loading=!1,t.success?(this.currentValue=t.result,this.$emit("input",this.currentValue),this.$emit("on-change",this.currentValue)):this.$Message.error(t.message)},handleError:function(t,e,a){this.loading=!1,this.$Message.error(t.toString())},handleChange:function(t){this.$emit("input",this.currentValue),this.$emit("on-change",this.currentValue)},setCurrentValue:function(t){t!==this.currentValue&&(this.currentValue=t,this.$emit("on-change",this.currentValue))}},watch:{value:function(t){this.setCurrentValue(t)}},mounted:function(){this.init()}},c=l,u=a("2877"),d=Object(u["a"])(c,r,s,!1,null,null,null);e["default"]=d.exports},"0c1c":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"set-password"},[a("Poptip",{attrs:{transfer:"",trigger:"focus",placement:"right",width:"250"}},[a("Input",{attrs:{type:"password",password:"",maxlength:t.maxlength,size:t.size,placeholder:t.placeholder,disabled:t.disabled,readonly:t.readonly},on:{"on-change":t.handleChange},model:{value:t.currentValue,callback:function(e){t.currentValue=e},expression:"currentValue"}}),a("div",{class:t.tipStyle,attrs:{slot:"content"},slot:"content"},[a("div",{staticClass:"words"},[t._v("强度 : "+t._s(t.strength))]),a("Progress",{staticStyle:{margin:"13px 0"},attrs:{percent:t.strengthValue,status:t.progressStatus,"hide-info":""}}),a("br"),t._v("请至少输入 6 个字符。请不要使 "),a("br"),t._v("用容易被猜到的密码。 ")],1)],1)],1)},s=[],n={name:"setPassword",props:{value:String,size:String,placeholder:{type:String,default:"请输入密码，长度为6-20个字符"},disabled:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},maxlength:{type:Number,default:20}},data:function(){return{currentValue:this.value,tipStyle:"password-tip-none",strengthValue:0,progressStatus:"normal",strength:"无",grade:0}},methods:{checkStrengthValue:function(t){var e=0;return/\d/.test(t)&&e++,/[a-z]/.test(t)&&e++,/[A-Z]/.test(t)&&e++,/\W/.test(t)&&e++,t.length>=10&&e++,this.grade=e,e},strengthChange:function(){if(!this.currentValue)return this.tipStyle="password-tip-none",this.strength="无",void(this.strengthValue=0);var t=this.checkStrengthValue(this.currentValue);t<=1?(this.progressStatus="wrong",this.tipStyle="password-tip-weak",this.strength="弱",this.strengthValue=33):t>=2&&t<=4?(this.progressStatus="normal",this.tipStyle="password-tip-middle",this.strength="中",this.strengthValue=66):(this.progressStatus="success",this.tipStyle="password-tip-strong",this.strength="强",this.strengthValue=100)},handleChange:function(t){this.strengthChange(),this.$emit("input",this.currentValue),this.$emit("on-change",this.currentValue,this.grade,this.strength)},setCurrentValue:function(t){t!==this.currentValue&&(this.currentValue=t,this.strengthChange(),this.$emit("on-change",this.currentValue,this.grade,this.strength))}},watch:{value:function(t){this.setCurrentValue(t)}}},i=n,o=(a("7c1e"),a("2877")),l=Object(o["a"])(i,r,s,!1,null,null,null);e["default"]=l.exports},"10fd":function(t,e,a){"use strict";a.d(e,"c",(function(){return r})),a.d(e,"b",(function(){return s})),a.d(e,"a",(function(){return n}));var r=function(t,e,a){var r=/^[a-zA-Z0-9_\u4e00-\u9fa5]{1,16}$/;e.length>16?a(new Error("长度不能超过16个字符")):r.test(e)?a():a(new Error("仅支持大小写英文、中文和下划线_"))},s=function(t,e,a){e.length<6?a(new Error("密码长度不得小于6位")):a()},n=function(t,e,a){var r=/^[1][3,4,5,6,7,8,9][0-9]{9}$/;r.test(e)?a():a(new Error("手机号格式错误"))}},"134a":function(t,e,a){},3906:function(t,e,a){},"6c1f":function(t,e,a){"use strict";a("a09c")},"7c1e":function(t,e,a){"use strict";a("3906")},a09c:function(t,e,a){},ae68:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"user-edit"},[a("Drawer",{attrs:{title:t.title,width:"720",draggable:"","mask-closable":"0"==t.type},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[a("div",{staticClass:"drawer-content",style:{maxHeight:t.maxHeight}},[a("div",{staticClass:"drawer-header"},[a("div",{staticStyle:{"margin-right":"16px"}},[t._v("基本信息")]),a("Avatar",{directives:[{name:"show",rawName:"v-show",value:"2"!=t.type,expression:"type != '2'"}],attrs:{src:t.form.avatar,size:"large"}})],1),a("Form",{directives:[{name:"show",rawName:"v-show",value:"2"!=t.type,expression:"type != '2'"}],attrs:{"label-colon":""}},[a("Row",{attrs:{gutter:32}},[a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"用户ID"}},[t._v(" "+t._s(t.form.id)+" "),a("Tooltip",{attrs:{trigger:"hover",placement:"right",content:"账户已禁用"}},[a("Icon",{directives:[{name:"show",rawName:"v-show",value:-1==t.form.status,expression:"form.status == -1"}],staticStyle:{"margin-left":"10px",cursor:"pointer"},attrs:{type:"md-lock",size:"18"}})],1)],1)],1),a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"登录账号"}},[t._v(" "+t._s(t.form.username)+" "),a("Tooltip",{attrs:{trigger:"hover",placement:"right",content:"密码强度："+t.form.passStrength}},[a("Icon",{directives:[{name:"show",rawName:"v-show",value:t.form.passStrength,expression:"form.passStrength"}],staticStyle:{"margin-left":"10px",cursor:"pointer"},attrs:{type:"md-key",color:t.passColor,size:"18"}})],1)],1)],1)],1)],1),a("Form",{ref:"form",attrs:{model:t.form,rules:t.formValidate,"label-position":"top"}},["2"==t.type?a("Row",{attrs:{gutter:32}},[a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"登录账号",prop:"username"}},[a("Input",{attrs:{autocomplete:"off",maxlength:16},model:{value:t.form.username,callback:function(e){t.$set(t.form,"username",e)},expression:"form.username"}})],1)],1),a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"密码",prop:"password"}},[a("SetPassword",{on:{"on-change":t.changePass},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1)],1)],1):t._e(),a("Row",{attrs:{gutter:32}},[a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"用户名",prop:"nickname"}},[a("Input",{model:{value:t.form.nickname,callback:function(e){t.$set(t.form,"nickname",e)},expression:"form.nickname"}})],1)],1),a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"邮箱",prop:"email"}},[a("Input",{model:{value:t.form.email,callback:function(e){t.$set(t.form,"email",e)},expression:"form.email"}})],1)],1)],1),a("Row",{attrs:{gutter:32}},[a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"手机号",prop:"mobile"}},[a("Input",{model:{value:t.form.mobile,callback:function(e){t.$set(t.form,"mobile",e)},expression:"form.mobile"}})],1)],1),a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"性别"}},[a("Select",{attrs:{transfer:""},model:{value:t.form.sex,callback:function(e){t.$set(t.form,"sex",e)},expression:"form.sex"}},t._l(this.$store.state.dict.sex,(function(e,r){return a("Option",{key:r,attrs:{value:e.value}},[t._v(t._s(e.title))])})),1)],1)],1)],1),a("Row",{attrs:{gutter:32}},[a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"所属部门"}},[a("department-tree-choose",{ref:"depTree",on:{"on-change":t.handleSelectDepTree}})],1)],1),a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"用户类型"}},[a("Select",{attrs:{transfer:"",placeholder:"请选择"},model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},[a("Option",{attrs:{value:0}},[t._v("普通用户")]),a("Option",{attrs:{value:1}},[t._v("管理员")])],1)],1)],1)],1),a("Row",{attrs:{gutter:32}},[a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"头像"}},[a("upload-pic-input",{model:{value:t.form.avatar,callback:function(e){t.$set(t.form,"avatar",e)},expression:"form.avatar"}})],1)],1),a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"角色分配",prop:"roleIds"}},[a("Select",{attrs:{multiple:"",transfer:""},model:{value:t.form.roleIds,callback:function(e){t.$set(t.form,"roleIds",e)},expression:"form.roleIds"}},t._l(t.roleList,(function(e){return a("Option",{key:e.id,attrs:{value:e.id,label:e.name}},[a("span",{staticStyle:{"margin-right":"10px"}},[t._v(t._s(e.name))]),a("span",{staticStyle:{color:"#ccc"}},[t._v(t._s(e.description))])])})),1)],1)],1)],1),a("Divider"),a("p",{staticClass:"drawer-title"},[t._v("个人资料")]),a("Row",{attrs:{gutter:32}},[a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"所在地区",prop:"address"}},[a("al-cascader",{attrs:{"data-type":"name",level:"2",transfer:""},model:{value:t.form.address,callback:function(e){t.$set(t.form,"address",e)},expression:"form.address"}})],1)],1),a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"街道地址"}},[a("Input",{model:{value:t.form.street,callback:function(e){t.$set(t.form,"street",e)},expression:"form.street"}})],1)],1)],1),a("Row",{attrs:{gutter:32}},[a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"生日",prop:"birth"}},[a("DatePicker",{staticStyle:{display:"block"},attrs:{type:"date",transfer:""},model:{value:t.form.birth,callback:function(e){t.$set(t.form,"birth",e)},expression:"form.birth"}})],1)],1),a("Col",{attrs:{span:"24"}},[a("FormItem",{attrs:{label:"简介"}},[a("Input",{attrs:{type:"textarea",rows:4},model:{value:t.form.description,callback:function(e){t.$set(t.form,"description",e)},expression:"form.description"}})],1)],1)],1)],1)],1),a("div",{directives:[{name:"show",rawName:"v-show",value:"0"!=t.type,expression:"type != '0'"}],staticClass:"drawer-footer br"},[a("Button",{attrs:{type:"primary",loading:t.submitLoading},on:{click:t.submit}},[t._v("提交")]),a("Button",{on:{click:function(e){t.visible=!1}}},[t._v("取消")])],1)])],1)},s=[],n=a("365c"),i=a("10fd"),o=a("09b5"),l=a("0bd5"),c=a("0c1c");function u(t){return u="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}var d={name:"user",components:{departmentTreeChoose:o["default"],uploadPicInput:l["default"],SetPassword:c["default"]},props:{value:{type:Boolean,default:!1},data:{type:Object},type:{type:String,default:"0"}},data:function(){return{roleList:[],visible:this.value,title:"",passColor:"",submitLoading:!1,maxHeight:510,form:{address:[]},formValidate:{username:[{required:!0,message:"请输入登录账号",trigger:"change"},{validator:i["c"],trigger:"change"}],nickname:[{required:!0,message:"请输入用户名",trigger:"change"}],mobile:[{required:!0,message:"请输入手机号",trigger:"change"},{validator:i["a"],trigger:"change"}],password:[{required:!0,message:"请输入密码",trigger:"change"},{validator:i["b"],trigger:"change"}],email:[{required:!0,message:"请输入邮箱地址"},{type:"email",message:"邮箱格式不正确"}]}}},methods:{init:function(){this.getRoleList()},getRoleList:function(){var t=this;Object(n["Eb"])().then((function(e){e.success&&(t.roleList=e.result)}))},handleSelectDepTree:function(t){this.form.departmentId=t},changePass:function(t,e,a){this.form.passStrength=a},submit:function(){var t=this;this.$refs.form.validate((function(e){e&&("object"==u(t.form.birth)&&(t.form.birth=t.format(t.form.birth,"yyyy-MM-dd")),"1"==t.type?(t.submitLoading=!0,Object(n["tb"])(t.form).then((function(e){t.submitLoading=!1,e.success&&(t.$Message.success("操作成功"),t.$emit("on-submit",!0),t.visible=!1)}))):(t.submitLoading=!0,Object(n["p"])(t.form).then((function(e){t.submitLoading=!1,e.success&&(t.$Message.success("操作成功"),t.$emit("on-submit",!0),t.visible=!1)}))))}))},setCurrentValue:function(t){if(t!==this.visible){if("1"==this.type?(this.title="编辑用户",this.maxHeight=Number(document.documentElement.clientHeight-121)+"px"):"2"==this.type?(this.title="添加用户",this.maxHeight=Number(document.documentElement.clientHeight-121)+"px"):(this.title="用户详情",this.maxHeight="100%"),this.$refs.form.resetFields(),"0"==this.type||"1"==this.type){var e=this.data;e.address?e.address=e.address.split(","):e.address=[],this.$refs.depTree.setData(e.departmentId,e.departmentTitle);var a=[];e.roles.forEach((function(t){a.push(t.id)})),e.roleIds=a,delete e.roles,delete e.permissions,"弱"==e.passStrength?this.passColor="#ed3f14":"中"==e.passStrength?this.passColor="#faad14":"强"==e.passStrength&&(this.passColor="#52c41a"),this.form=e}else this.$refs.depTree.setData("",""),this.form={type:0,sex:"",address:[]};this.visible=t}}},watch:{value:function(t){this.setCurrentValue(t)},visible:function(t){this.$emit("input",t)}},mounted:function(){this.init()}},p=d,h=(a("f713"),a("2877")),m=Object(h["a"])(p,r,s,!1,null,null,null);e["default"]=m.exports},f713:function(t,e,a){"use strict";a("134a")}}]);