(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-618dec3b","chunk-2d20f739"],{"12c1c":function(e,t,a){"use strict";a("c91a")},"55b8":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"search"},[a("Card",[a("Tabs",{attrs:{animated:!1},on:{"on-click":e.handleClickTab}},[a("TabPane",{attrs:{label:"Redis管理"}},[a("Row",{directives:[{name:"show",rawName:"v-show",value:e.openSearch,expression:"openSearch"}],nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSearch(t)}}},[a("Form",{ref:"searchForm",attrs:{model:e.searchForm,inline:"","label-width":40}},[a("FormItem",{attrs:{label:"Key",prop:"key"}},[a("Input",{staticStyle:{width:"200px"},attrs:{type:"text",placeholder:"请输入Key",clearable:""},model:{value:e.searchForm.key,callback:function(t){e.$set(e.searchForm,"key",t)},expression:"searchForm.key"}})],1),a("FormItem",{staticClass:"br",staticStyle:{"margin-left":"-35px"}},[a("Button",{attrs:{type:"primary",icon:"ios-search"},on:{click:e.handleSearch}},[e._v("搜索")]),a("Button",{on:{click:e.handleReset}},[e._v("重置")])],1)],1)],1),a("Row",{staticClass:"operation"},[a("Button",{attrs:{type:"primary",icon:"md-add"},on:{click:e.add}},[e._v("添加")]),a("Button",{attrs:{type:"error",icon:"md-trash"},on:{click:e.clear}},[e._v("清空所有")]),a("Button",{attrs:{icon:"md-trash"},on:{click:e.delAll}},[e._v("批量删除")]),a("Button",{attrs:{icon:"md-refresh"},on:{click:e.getDataList}},[e._v("刷新")]),a("Button",{attrs:{type:"dashed"},on:{click:function(t){e.openSearch=!e.openSearch}}},[e._v(e._s(e.openSearch?"关闭搜索":"开启搜索"))]),a("Button",{attrs:{type:"dashed"},on:{click:function(t){e.openTip=!e.openTip}}},[e._v(e._s(e.openTip?"关闭提示":"开启提示"))])],1),a("Row",{directives:[{name:"show",rawName:"v-show",value:e.openTip,expression:"openTip"}]},[a("Alert",{attrs:{"show-icon":""}},[e._v(" 已选择 "),a("span",{staticClass:"select-count"},[e._v(e._s(e.selectList.length))]),e._v(" 项 "),a("a",{staticClass:"select-clear",on:{click:e.clearSelectAll}},[e._v("清空")])])],1),a("Row",[a("Table",{ref:"table",attrs:{loading:e.loading,border:"",columns:e.columns,data:e.data,sortable:"custom"},on:{"on-sort-change":e.changeSort,"on-selection-change":e.changeSelect}})],1),a("Row",{staticClass:"page",attrs:{type:"flex",justify:"end"}},[a("Page",{attrs:{current:e.pageNumber,total:e.total,"page-size":e.pageSize,"page-size-opts":[10,20,50],size:"small","show-total":"","show-elevator":"","show-sizer":""},on:{"on-change":e.changePage,"on-page-size-change":e.changePageSize}})],1)],1),a("TabPane",{attrs:{name:"monitor",label:"Redis监控"}},[a("redis-monitor")],1)],1)],1),a("Modal",{attrs:{title:e.modalTitle,"mask-closable":!1,width:500},model:{value:e.modalVisible,callback:function(t){e.modalVisible=t},expression:"modalVisible"}},[a("Form",{ref:"form",attrs:{model:e.form,"label-width":80,rules:e.formValidate}},[a("FormItem",{attrs:{label:"Key",prop:"key"}},[a("Input",{staticStyle:{width:"100%"},model:{value:e.form.key,callback:function(t){e.$set(e.form,"key",t)},expression:"form.key"}})],1),a("FormItem",{attrs:{label:"Value",prop:"value"}},[a("Input",{staticStyle:{width:"100%"},attrs:{type:"textarea",rows:5},model:{value:e.form.value,callback:function(t){e.$set(e.form,"value",t)},expression:"form.value"}})],1),a("FormItem",{attrs:{label:"过期时间",prop:"expireTime"}},[a("Tooltip",{attrs:{trigger:"hover",placement:"right",content:"永久不过期设为-1"}},[a("InputNumber",{attrs:{min:-1},model:{value:e.form.expireTime,callback:function(t){e.$set(e.form,"expireTime",t)},expression:"form.expireTime"}})],1),a("span",{staticStyle:{"margin-left":"5px"}},[e._v("秒")])],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"text"},on:{click:function(t){e.modalVisible=!1}}},[e._v("取消")]),a("Button",{attrs:{type:"primary",loading:e.submitLoading},on:{click:e.handleSubmit}},[e._v("提交")])],1)],1)],1)},s=[],n=a("365c"),r=a("b44e"),o={name:"redis-notCache",components:{redisMonitor:r["default"]},data:function(){var e=this;return{openSearch:!0,openTip:!0,loading:!0,modalType:0,modalVisible:!1,modalTitle:"",searchForm:{pageNumber:1,pageSize:10,sort:"createTime",order:"desc"},form:{key:"",value:"",expireTime:null},formValidate:{key:[{required:!0,message:"不能为空",trigger:"change"}],value:[{required:!0,message:"不能为空",trigger:"change"}],expireTime:[{required:!0,type:"number",message:"不能为空",trigger:"change"}]},submitLoading:!1,selectList:[],columns:[{type:"selection",width:60,align:"center"},{type:"index",width:60,align:"center"},{title:"Key",key:"key",minWidth:200,sortable:!0},{title:"Value",key:"value",minWidth:400,ellipsis:!0},{title:"过期时间(秒)",key:"expireTime",width:150},{title:"操作",key:"action",align:"center",fixed:"right",width:150,render:function(t,a){return t("div",[t("a",{on:{click:function(){e.edit(a.row)}}},"编辑"),t("Divider",{props:{type:"vertical"}}),t("a",{on:{click:function(){e.remove(a.row)}}},"删除")])}}],data:[],pageNumber:1,pageSize:10,total:0}},methods:{init:function(){var e=this;Object(n["fc"])().then((function(t){var a=t.result.keySize;a>1e5&&e.$Notice.info({title:"提示",desc:"检测到存储的数据已超过10万条，为避免加载过多数据当前仅显示前10万条数据"})})),this.getDataList()},handleClickTab:function(e){"monitor"==e&&this.$Message.info("每隔5秒刷新一次数据，请耐心等待图表绘制")},changePage:function(e){this.searchForm.pageNumber=e,this.getDataList(),this.clearSelectAll()},changePageSize:function(e){this.searchForm.pageSize=e,this.getDataList()},handleSearch:function(){this.searchForm.pageNumber=1,this.searchForm.pageSize=10,this.getDataList()},handleReset:function(){this.$refs.searchForm.resetFields(),this.searchForm.pageNumber=1,this.searchForm.pageSize=10,this.getDataList()},changeSort:function(e){this.searchForm.sort=e.key,this.searchForm.order=e.order,"normal"==e.order&&(this.searchForm.order=""),this.getDataList()},clearSelectAll:function(){this.$refs.table.selectAll(!1)},changeSelect:function(e){this.selectList=e},getDataList:function(){var e=this;this.loading=!0,Object(n["dc"])(this.searchForm).then((function(t){e.loading=!1,t.success&&(e.data=t.result.content,e.total=t.result.totalElements,0==e.data.length&&e.searchForm.pageNumber>1&&(e.searchForm.pageNumber-=1,e.getDataList()))}))},handleSubmit:function(){var e=this;this.$refs.form.validate((function(t){t&&(e.submitLoading=!0,Object(n["Hc"])(e.form).then((function(t){e.submitLoading=!1,t.success&&(e.$Message.success("操作成功"),e.getDataList(),e.modalVisible=!1)})))}))},add:function(){this.modalType=0,this.modalTitle="添加",this.$refs.form.resetFields(),delete this.form.id,this.modalVisible=!0},edit:function(e){var t=this;if(e.value.indexOf("非字符")>-1)this.$Message.warning("非字符格式数据暂不支持编辑");else{for(var a in this.modalType=1,this.modalTitle="编辑",this.$refs.form.resetFields(),e)null==e[a]&&(e[a]="");var i=JSON.stringify(e),s=JSON.parse(i);this.form.value="读取中...",this.form.expireTime=null,Object(n["cc"])(s.key).then((function(e){t.form.value="",e.success&&(s.value=e.result.value,s.expireTime=e.result.expireTime,t.form=s)})),this.modalVisible=!0}},clear:function(e){var t=this;this.$Modal.confirm({title:"请谨慎进行此操作！",content:"您确认要彻底清空删除所有数据?",loading:!0,onOk:function(){Object(n["x"])().then((function(e){t.$Modal.remove(),e.success&&(t.$Message.success("操作成功"),t.getDataList())}))}})},remove:function(e){var t=this;this.$Modal.confirm({title:"确认删除",content:"您确认要删除 "+e.key+" ?",loading:!0,onOk:function(){Object(n["N"])({keys:e.key}).then((function(e){t.$Modal.remove(),e.success&&(t.$Message.success("操作成功"),t.clearSelectAll(),t.getDataList())}))}})},delAll:function(){var e=this;this.selectList.length<=0?this.$Message.warning("您还未选择要删除的数据"):this.$Modal.confirm({title:"确认删除",content:"您确认要删除所选的 "+this.selectList.length+" 条数据?",loading:!0,onOk:function(){var t="";e.selectList.forEach((function(e){t+=e.key+","})),t=t.substring(0,t.length-1),Object(n["N"])({keys:t}).then((function(t){e.$Modal.remove(),t.success&&(e.$Message.success("操作成功"),e.clearSelectAll(),e.getDataList())}))}})}},mounted:function(){this.init()}},l=o,c=(a("12c1c"),a("2877")),m=Object(c["a"])(l,i,s,!1,null,null,null);t["default"]=m.exports},b44e:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Row",[a("Col",{attrs:{span:"12"}},[a("apexchart",{ref:"memoryInfo",attrs:{type:"area",height:"350",options:e.memory.chartOptions,series:e.memory.series}})],1),a("Col",{attrs:{span:"12"}},[a("apexchart",{ref:"keySize",attrs:{type:"area",height:"350",options:e.key.chartOptions,series:e.key.series}})],1)],1),a("Row",[a("Divider",{attrs:{orientation:"left"}},[e._v("Redis详细信息")]),a("Table",{attrs:{columns:e.columns,data:e.redisInfo,"show-header":!1,size:"small"}})],1)],1)},s=[],n=a("365c"),r={name:"redisMonitor",data:function(){return{memory:{series:[],chartOptions:{chart:{animations:{enabled:!0,easing:"linear",dynamicAnimation:{speed:5e3}},toolbar:{show:!1},zoom:{enabled:!1}},dataLabels:{enabled:!1},stroke:{curve:"smooth"},title:{text:"Redis内存实时占用情况（KB）",align:"left"},markers:{size:0},xaxis:{},yaxis:{},legend:{show:!1}},data:[],xdata:[]},key:{series:[],chartOptions:{chart:{animations:{enabled:!0,easing:"linear",dynamicAnimation:{speed:5e3}},toolbar:{show:!1},zoom:{enabled:!1}},dataLabels:{enabled:!1},colors:["#f5564e"],stroke:{curve:"smooth"},title:{text:"Redis key实时数量（个）",align:"left"},markers:{size:0},xaxis:{},yaxis:{},legend:{show:!1}},data:[],xdata:[]},columns:[{key:"key",minWidth:200},{key:"description",minWidth:500},{key:"value",width:400}],redisInfo:[],timer:null}},methods:{init:function(){this.getData(),this.getInfo()},getData:function(){var e=this,t=1e10,a=1e10,i=-1e10,s=-1e10;this.timer=setInterval((function(){Object(n["gc"])().then((function(a){var s=Number(a.result.memory)/1024;s<t&&(t=s),s>i&&(i=s),e.memory.data.push(Number(s.toFixed(2))),e.memory.xdata.push(a.result.time),e.memory.data.length>=6&&(e.memory.data.shift(),e.memory.xdata.shift()),e.$refs.memoryInfo.updateSeries([{name:"内存(KB)",data:e.memory.data}]),e.$refs.memoryInfo.updateOptions({xaxis:{categories:e.memory.xdata},yaxis:{min:t-2,max:i+2}},!0,!0)})),Object(n["fc"])().then((function(t){var i=t.result.keySize;i<a&&(a=i),i>s&&(s=i),e.key.data.push(i),e.key.xdata.push(t.result.time),e.key.data.length>=6&&(e.key.data.shift(),e.key.xdata.shift()),e.$refs.keySize.updateSeries([{name:"key数量",data:e.key.data}]),e.$refs.keySize.updateOptions({xaxis:{categories:e.key.xdata},yaxis:{min:a-2,max:s+2}},!0,!0)}))}),5e3)},getInfo:function(){var e=this;Object(n["ec"])().then((function(t){var a=[];t.result.forEach((function(e){e.description&&a.push(e)})),e.redisInfo=a}))}},beforeDestroy:function(){this.timer&&clearInterval(this.timer)},mounted:function(){this.init()}},o=r,l=a("2877"),c=Object(l["a"])(o,i,s,!1,null,null,null);t["default"]=c.exports},c91a:function(e,t,a){}}]);